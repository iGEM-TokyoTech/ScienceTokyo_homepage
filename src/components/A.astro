---
// src/components/A.astro
import type { HTMLAttributes } from "astro/types";
const { href, class: className, ...restProps } = Astro.props;
---

<a
  href={href}
  class:list={["astro-anchor", className]}
  target={href?.startsWith("#") ? undefined : "_blank"}
  {...restProps}
>
  <slot />
  <div class="overlink"></div>
</a>


<script is:inline>
  function scrollToAnchor(href, offset = 80) {
    if (!href.startsWith("#")) return;
    const id = href.slice(1);
    const target = document.getElementById(id);
    if (!target) return;
    const y = target.getBoundingClientRect().top + window.scrollY - offset;
    window.scrollTo({ top: y, behavior: "smooth" });
    history.replaceState(null, "", href);
  }

  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll('a.astro-anchor[href^="#"]').forEach(anchor => {
      anchor.addEventListener("click", (e) => {
        e.preventDefault();
        const href = anchor.getAttribute("href");
        if (href) {
          scrollToAnchor(href, 80);
        }
      });
    });
  });
</script>


<style>
  .astro-anchor {
    text-decoration: none;
    color: black;
    position: relative;
  }
  .astro-anchor .overlink {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 100;
    background: transparent;
    cursor: pointer;
  }
</style>
